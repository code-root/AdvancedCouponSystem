# ๐ ูุธุงู ุชุชุจุน Sessions ูุงูุฅุดุนุงุฑุงุช

## โ ุชู ุฅูุดุงุคู ุจูุฌุงุญ!

### ๐ฆ ุงููููุฒุงุช:

1. **ุชุชุจุน ูุงูู ููู Sessions:**
   - ูุนูููุงุช ุงูุฌูุงุฒ (Desktop, Mobile, Tablet)
   - ููุน ุงููุชุตูุญ ูุงูุฅุตุฏุงุฑ
   - ูุธุงู ุงูุชุดุบูู
   - ุงููููุน ุงูุฌุบุฑุงูู (ุงูุฏููุฉุ ุงููุฏููุฉุ ุงูุฅุญุฏุงุซูุงุช)
   - ุนููุงู IP
   - ุงูู Referrer URL (ูู ุฃูู ุฌุงุก ุงููุณุชุฎุฏู)
   - Landing Page (ุฃูู ุตูุญุฉ ุฏุฎููุง)
   - UTM Parameters (ููุชุชุจุน ุงูุชุณูููู)

2. **ุฅุฏุงุฑุฉ ุงูุณูุดูุงุช:**
   - ุนุฑุถ ุงูุณูุดู ุงูุญุงูู
   - ุนุฑุถ ุฌููุน ุงูุณูุดูุงุช ุงูุฃุฎุฑู
   - ุฅููุงุก ุณูุดู ูุนูู
   - ุฅููุงุก ุฌููุน ุงูุณูุดูุงุช ุงูุฃุฎุฑู
   - ุชูุธูู ุงูุณูุดูุงุช ุงูููุชููุฉ

3. **ุงูุฅุดุนุงุฑุงุช:**
   - ุฅุดุนุงุฑ ููุฑู ุนูุฏ ุชุณุฌูู ุฏุฎูู ุฌุฏูุฏ
   - ุชูุงุตูู ูุงููุฉ ุนู ุงูุฌูุงุฒ ูุงููููุน
   - ุนุฑุถ ุงูุฅุดุนุงุฑุงุช ูู Topbar
   - ุตูุญุฉ ูุงููุฉ ููุฅุดุนุงุฑุงุช

4. **ุงูุชุญุฏูุซ ุงููุจุงุดุฑ (Real-time):**
   - ุงุณุชุฎุฏุงู Pusher ููุชุญุฏูุซ ุงูููุฑู
   - ุชูุจูู ุนูุฏ ุชุณุฌูู ุฏุฎูู ูู ุฌูุงุฒ ุฌุฏูุฏ
   - ุชุญุฏูุซ ูุงุฆูุฉ ุงูุณูุดูุงุช ุชููุงุฆูุงู

---

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ:

### 1. ุชุดุบูู Migrations:

```bash
php artisan migrate
```

### 2. ุฅุนุฏุงุฏ Broadcasting (ุงุฎุชูุงุฑู - ููุชุญุฏูุซ ุงููุจุงุดุฑ):

#### ุฃ. ุฅุฐุง ููุช ุชุฑูุฏ ุงุณุชุฎุฏุงู Pusher:

1. ุณุฌู ูู [Pusher.com](https://pusher.com) (ูุฌุงูู ุญุชู 200k ุฑุณุงูุฉ/ููู)
2. ุฃูุดุฆ App ุฌุฏูุฏ
3. ุงุญุตู ุนูู ุงููุนูููุงุช ุงูุชุงููุฉ:
   - App ID
   - Key
   - Secret
   - Cluster

4. ูู `.env`:
```env
BROADCAST_DRIVER=pusher

PUSHER_APP_ID=your_app_id
PUSHER_APP_KEY=your_app_key
PUSHER_APP_SECRET=your_app_secret
PUSHER_APP_CLUSTER=eu
```

#### ุจ. ุฅุฐุง ูู ุชุฑ ูุฏ ุงุณุชุฎุฏุงู Pusher:
ูู `.env`:
```env
BROADCAST_DRIVER=log
```

โ๏ธ **ููุงุญุธุฉ:** ุจุฏูู Pusherุ ูู ูููู ููุงู ุชุญุฏูุซ ูุจุงุดุฑุ ููู ูู ุงูููุฒุงุช ุงูุฃุฎุฑู ุณุชุนูู!

### 3. ูุณุญ Cache:

```bash
php artisan config:clear
php artisan cache:clear
```

---

## ๐ฑ ููููุฉ ุงูุงุณุชุฎุฏุงู:

### ุงููุตูู ููุตูุญุฉ:

```
/dashboard/sessions
```

ุฃู ูู Sidebar:
```
Security โ Login Sessions
```

### ุนุฑุถ ุงูุฅุดุนุงุฑุงุช:

1. **ูู Topbar**: ุงุถุบุท ุนูู ุฃููููุฉ ุงูุฌุฑุณ ๐
2. **ุตูุญุฉ ูุงููุฉ**: Sidebar โ Notifications

---

## ๐ฏ ุงูููุฒุงุช ุงูุชูุตูููุฉ:

### 1. Current Session Card (ุงูุณูุดู ุงูุญุงูู):
- ูุนูููุงุช ุงูุฌูุงุฒ ุงูุญุงูู
- ุงููุชุตูุญ
- ุงููููุน
- IP Address
- ูู ุฃูู ุฌุงุก (Referrer)

### 2. Other Sessions (ุงูุณูุดูุงุช ุงูุฃุฎุฑู):
- ูุงุฆูุฉ ุจุฌููุน ุงูุฃุฌูุฒุฉ ุงููุณุฌู ุฏุฎูููุง
- ุญุงูุฉ ูู ุณูุดู (Active/Inactive)
- ุขุฎุฑ ูุดุงุท
- ุฅููุงููุฉ ุฅููุงุก ุฃู ุณูุดู
- ุฅููุงููุฉ ุฅููุงุก ุฌููุน ุงูุณูุดูุงุช ุงูุฃุฎุฑู

### 3. Session Details (ุชูุงุตูู ูุงููุฉ):
- Device: ููุน ุงูุฌูุงุฒ ูุงุณูู
- Browser: ุงููุชุตูุญ ูุงูุฅุตุฏุงุฑ
- Platform: ูุธุงู ุงูุชุดุบูู
- Location: ุงูุฏููุฉุ ุงููุฏููุฉุ ุงูููุทูุฉ
- Coordinates: ุงูุฅุญุฏุงุซูุงุช (ุฑุงุจุท Google Maps)
- IP Address: ุนููุงู IP
- Timezone: ุงูููุทูุฉ ุงูุฒูููุฉ
- Referrer: ูู ุฃูู ุฌุงุก
- Landing Page: ุฃูู ุตูุญุฉ ุฏุฎููุง
- UTM Parameters: ูุนูููุงุช ุงูุญููุฉ ุงูุชุณููููุฉ
- Login Time: ููุช ุชุณุฌูู ุงูุฏุฎูู
- Last Activity: ุขุฎุฑ ูุดุงุท
- Duration: ูุฏุฉ ุงูุณูุดู

### 4. ุฅุดุนุงุฑ ุชุณุฌูู ุงูุฏุฎูู:
ุนูุฏ ุชุณุฌูู ุฏุฎูู ุฌุฏูุฏุ ูุญุตู ุงููุณุชุฎุฏู ุนูู:
- โ Database Notification (ูุธูุฑ ูู ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช)
- โ Browser Notification (ุฅุฐุง ูุงู ุงูุตูุญุฉ ููุชูุญุฉ - ุนุจุฑ Pusher)
- โ Email Notification (ุงุฎุชูุงุฑู - ูููู ุชูุนููู)

---

## ๐ง ุงูุชุฎุตูุต:

### ุชุนุทูู Email Notifications:

ูู `app/Notifications/NewLoginNotification.php`:
```php
public function via(object $notifiable): array
{
    return ['database', 'broadcast']; // ุฃุฒู 'mail'
}
```

### ุชุบููุฑ ูุฏุฉ Session:

ูู `config/session.php`:
```php
'lifetime' => 120, // ุจุงูุฏูุงุฆู
```

### ุชุนุทูู Geo-location:

ูู `app/Http/Middleware/TrackUserSession.php`:
```php
protected function getLocationFromIP(string $ip): array
{
    return []; // ูุง ุฌูุจ ูููููุน
}
```

---

## ๐ API ููู IP Location:

ูุณุชุฎุฏู ุงููุธุงู `ipapi.co` ุงููุฌุงูู:
- **ุงูุญุฏ:** 1000 ุทูุจ/ููู
- **Cache:** 24 ุณุงุนุฉ ููู IP
- **ูุง ูุญุชุงุฌ API Key**

ุฅุฐุง ุชุฌุงูุฒุช ุงูุญุฏุ ููููู:
1. ุงุณุชุฎุฏุงู API Key ูู ipapi.co ($10/ุดูุฑ)
2. ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุฃุฎุฑู ูุซู:
   - ip-api.com (ูุฌุงููุ 45 ุทูุจ/ุฏูููุฉ)
   - ipgeolocation.io (ูุฌุงููุ 1000 ุทูุจ/ููู)

---

## ๐ ุงูุฌุฏุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

### user_sessions:
```sql
- id
- user_id
- session_id (Laravel session ID)
- ip_address
- user_agent
- device_type, device_name, platform
- browser, browser_version
- country, country_code, region, city
- timezone, latitude, longitude
- referrer_url, landing_page
- utm_source, utm_medium, utm_campaign
- last_activity, login_at, expires_at
- is_active, logout_reason
- created_at, updated_at
```

### notifications:
```sql
- id
- type (NewLoginNotification)
- notifiable_type (User)
- notifiable_id (user_id)
- data (JSON - ูุนูููุงุช ุงูุฅุดุนุงุฑ)
- read_at (ููุช ุงููุฑุงุกุฉ)
- created_at, updated_at
```

---

## ๐จ ุงูุตูุญุงุช ุงูููุดุฃุฉ:

1. โ `/dashboard/sessions` - ุนุฑุถ ุฌููุน ุงูุณูุดูุงุช
2. โ `/dashboard/sessions/{id}` - ุชูุงุตูู ุณูุดู ูุนูู
3. โ `/dashboard/notifications` - ุนุฑุถ ุฌููุน ุงูุฅุดุนุงุฑุงุช

---

## ๐ ุฅุนุฏุงุฏ Pusher (ููุชุญุฏูุซ ุงููุจุงุดุฑ):

### 1. ุชุณุฌูู ูู Pusher:
https://pusher.com/signup

### 2. ุฅูุดุงุก App ุฌุฏูุฏ:
- ุงุณู App: AdvancedCouponSystem
- Cluster: ุงุฎุชุฑ ุฃูุฑุจ ููุทูุฉ (eu, us-east-1, ap-1)

### 3. ูุณุฎ ุงูุจูุงูุงุช ุฅูู .env:
```env
BROADCAST_DRIVER=pusher

PUSHER_APP_ID=1234567
PUSHER_APP_KEY=abcdef123456
PUSHER_APP_SECRET=xyz789secret
PUSHER_HOST=
PUSHER_PORT=443
PUSHER_SCHEME=https
PUSHER_APP_CLUSTER=eu

VITE_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
VITE_PUSHER_HOST="${PUSHER_HOST}"
VITE_PUSHER_PORT="${PUSHER_PORT}"
VITE_PUSHER_SCHEME="${PUSHER_SCHEME}"
VITE_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
```

### 4. ูุณุญ Cache:
```bash
php artisan config:clear
```

### 5. ุชุดุบูู Queue Worker (ุฅุฐุง ุงุณุชุฎุฏูุช ShouldQueue):
```bash
php artisan queue:work
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ:

### 1. ุงูุชุญ ุงููุชุตูุญ:
```
http://127.0.0.1:8000/dashboard/sessions
```

### 2. ุณุฌู ุฏุฎูู ูู ุฌูุงุฒ/ูุชุตูุญ ุขุฎุฑ:
- ุงูุชุญ ูุชุตูุญ ุขุฎุฑ (Chrome, Firefox)
- ุฃู ุงุณุชุฎุฏู Incognito Mode
- ุณุฌู ุฏุฎูู ุจููุณ ุงูุญุณุงุจ

### 3. ูุฌุจ ุฃู ูุญุฏุซ:
- โ ูุธูุฑ notification ูู Topbar
- โ ุฅุฐุง ููุช ูู ุตูุญุฉ Sessionsุ ุณูุธูุฑ SweetAlert
- โ ุณูุชู ุชุญุฏูุซ ุงููุงุฆูุฉ ุชููุงุฆูุงู
- โ ุงูุนุฏุฏ ูู Badge ุณูุชุญุฏุซ

### 4. ุงุฎุชุจุงุฑ ุฅููุงุก ุณูุดู:
- ุงุถุบุท "Logout" ุนูู ุฃู ุณูุดู
- ูุฌุจ ุฃู ูุชู ุฅููุงุคู ูุจุงุดุฑุฉ
- ุงููุณุชุฎุฏู ุนูู ุงูุฌูุงุฒ ุงูุขุฎุฑ ุณูุชู ุชุณุฌูู ุฎุฑูุฌู

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ:

1. **Shared Hosting**: ูู ูุนูู Pusher real-timeุ ููู ุงูุฅุดุนุงุฑุงุช ุณุชุนูู
2. **Performance**: ุงูุจูุงูุงุช ุชูุฎุฒู ูู Cache ููุฏุฉ 24 ุณุงุนุฉ
3. **Privacy**: ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ ุชูุฑูุจูุฉ (ุนูู ูุณุชูู ุงููุฏููุฉ)
4. **Security**: ุฌููุน routes ูุญููุฉ ุจู auth middleware

---

## ๐ ุงูุฎูุงุตุฉ:

ุชู ุฅูุดุงุก ูุธุงู ูุงูู ูุชุชุจุน Sessions ูุน:
- โ ุฌููุน ุงููุนูููุงุช ุงููุทููุจุฉ (ุฌูุงุฒุ ูุชุตูุญุ ูููุนุ IPุ referrer)
- โ ุฅุดุนุงุฑุงุช ุนูุฏ ุชุณุฌูู ุฏุฎูู ุฌุฏูุฏ
- โ ุฅุฏุงุฑุฉ ูุงููุฉ ููุณูุดูุงุช
- โ ุชุญุฏูุซ ูุจุงุดุฑ (ูุน Pusher)
- โ ูุงุฌูุฉ ุฌูููุฉ ููุชุฌุงูุจุฉ

**ุงุณุชูุชุน ุจุงูููุฒุฉ ุงูุฌุฏูุฏุฉ!** ๐

